<%= render "shared/navbar" %>

<!-- ======================= Map ======================= -->
<div class="container">
  <div
    style="width: 100%; height: 600px;"
    data-controller="map"
    data-map-markers-value="<%= @markers.to_json %>"
    data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>">
  </div>
</div>

<!-- =================== Top Trendy Activities =================== -->
<div class="container mt-3">
  <div class="section-block">
    <h2 class="section-title">
      <span class="chip">Top Trendy Activities</span>
    </h2>

    <div class="swipe-carousel" data-controller="swipe">
      <div class="swipe-carousel__track" data-swipe-target="track" role="region" aria-label="Top trendy activities">
        <% @activities.last(10).each do |activity| %>
          <div class="card h-100 position-relative"><!-- ðŸ‘ˆ rend possible le stretched-link global -->

            <!-- Lien Ã©tirÃ© qui couvre TOUTE la card -->
            <%= link_to "", activity_path(activity),
                        class: "stretched-link",
                        aria: { label: "View #{activity.name}" } %>

            <% if activity.photo.attached? %>
              <%= cl_image_tag activity.photo.key, class: "card-img-top", alt: activity.name %>
            <% else %>
              <%= image_tag "placeholder.svg", class: "card-img-top", alt: "Placeholder" %>
            <% end %>

            <div class="card-body d-flex flex-column">
              <h5 class="card-title"><strong><%= activity.name %></strong></h5>
              <p class="description flex-grow-1"><%= activity.description %></p>

              <!-- Chip de catÃ©gorie -->
              <div class="text-start mt-2">
                <span class="chip"><%= activity.category.name %></span>
              </div>
            </div>

            <!-- Footer : Adresse + Ã‰toiles (non cliquables ici, la card entiÃ¨re mÃ¨ne Ã  la show) -->
            <div class="card-footer bg-transparent footer-stack">
              <p class="mb-1 address-line"><%= activity.address %></p>
              <div class="rating-row d-inline-flex align-items-center gap-2">
                <%= render "shared/rating",
                           rating: activity.rating_avg,
                           reviews_count: activity.reviews_count %>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>

<!-- ==================== Must-See Activities ==================== -->
<div class="container mt-3">
  <div class="section-block">
    <h2 class="section-title">
      <span class="chip">Must-See Activities</span>
    </h2>

    <div class="swipe-carousel" data-controller="swipe">
      <div class="swipe-carousel__track" data-swipe-target="track" role="region" aria-label="Must-see activities">
        <% @activities.first(10).each do |activity| %>
          <div class="card h-100 position-relative"><!-- ðŸ‘ˆ rend possible le stretched-link global -->

            <!-- Lien Ã©tirÃ© qui couvre TOUTE la card -->
            <%= link_to "", activity_path(activity),
                        class: "stretched-link",
                        aria: { label: "View #{activity.name}" } %>

            <% if activity.photo.attached? %>
              <%= cl_image_tag activity.photo.key, class: "card-img-top", alt: activity.name %>
            <% else %>
              <%= image_tag "placeholder.svg", class: "card-img-top", alt: "Placeholder" %>
            <% end %>

            <div class="card-body d-flex flex-column">
              <h5 class="card-title"><strong><%= activity.name %></strong></h5>
              <p class="description flex-grow-1"><%= activity.description %></p>

              <!-- Chip de catÃ©gorie -->
              <div class="text-start mt-2">
                <span class="chip"><%= activity.category.name %></span>
              </div>
            </div>

            <!-- Footer : Adresse + Ã‰toiles (non cliquables ici) -->
            <div class="card-footer bg-transparent footer-stack">
              <p class="mb-1 address-line"><%= activity.address %></p>
              <div class="rating-row d-inline-flex align-items-center gap-2">
                <%= render "shared/rating",
                           rating: activity.rating_avg,
                           reviews_count: activity.reviews_count %>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>

